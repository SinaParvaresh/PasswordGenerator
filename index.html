<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random Password Generator</title>
    <link href="/stylesheets/css/bulma.css" rel="stylesheet" />
    <link href="/stylesheets/css/style.css" rel="stylesheet" />
  </head>

  <body>
    <form id="random-gen">
      <div>
        <label class="labels">Password Length:</label>
        <input type="number" class="pass-num" id="Length" />
      </div>
      <div>
        <label class="labels">Include Symbol:</label>
        <input type="checkbox" class="check" id="Symbol" />
        <label>(e.g. !%#$)</label>
      </div>
      <div>
        <label class="labels">Include Numbers:</label>
        <input type="checkbox" class="check" id="Numbers" />
        <label>(e.g. 1234)</label>
      </div>
      <div>
        <label class="labels">Include Lowercase:</label>
        <input type="checkbox" class="check" id="Lowercase" />
        <label>(e.g. abcd)</label>
      </div>
      <div>
        <label class="labels">Include Uppercase:</label>
        <input type="checkbox" class="check" id="Uppercase" />
        <label>(e.g. ABCD)</label>
      </div>
      <div id="gen-pass">
        <button class="button is-rounded" id="generate-pass">
          Generate Password
        </button>
      </div>

      <div id="new-password">
        <label>New Password:</label>
        <input type="text" id="pass-text" />
        <button type="button" class="button" id="Copy">Copy</button>
      </div>
    </form>
    <script>
      let checkboxes, pass_len;
      const Copy = document.getElementById("Copy");
      const passtext = document.getElementById("pass-text");

      //Creating Copy Button Function
      Copy.onclick = function () {
        passtext.select();
        document.execCommand("copy");
      };

      document
        .querySelector("#gen-pass")
        .addEventListener("click", function () {
          event.preventDefault();
          checkboxes = document.querySelectorAll(".check:checked");
          pass_len = parseInt(document.querySelector(".pass-num").value);

          //# of check boxes must be equal or less than total pass length
          if (checkboxes.length > pass_len) {
            return console.error();
          }

          const requestBody = {
            pass_len: parseInt(document.querySelector(".pass-num").value),
            includeSymbol: document.querySelector("#Symbol").checked,
            includeNumbers: document.querySelector("#Numbers").checked,
            includeLowercase: document.querySelector("#Lowercase").checked,
            includeUppercase: document.querySelector("#Uppercase").checked,
          };

          fetch("http://localhost:4000/pw", {
            method: "POST", // *GET, POST, PUT, DELETE, etc.
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(requestBody), // body data type must match "Content-Type" header
          })
            .then((response) => response.json())
            .then(
              (data) => (document.getElementById("pass-text").value = data)
            );
        });
    </script>
  </body>
</html>
